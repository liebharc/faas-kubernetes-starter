name: CI

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Start minikube
        uses: medyagh/setup-minikube@master
      - name: Try the cluster !
        run: kubectl get pods -A
      - name: Get Helm3
        run: curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3
      - name: Prepare Helm3 install
        run: chmod 700 get_helm.sh
      - name: Helm3 install
        run: ./get_helm.sh
      - name: Get Fission
        run: curl -O https://github.com/fission-suite/fission/releases/download/2.17.0/fission-cli-ubuntu-20.04-x86_64
      - name: Prepare Fission install
        run: chmod a+x ./fission-cli-ubuntu-2
      - name: Fission install
        run: export PATH=$PATH:$(pwd)
